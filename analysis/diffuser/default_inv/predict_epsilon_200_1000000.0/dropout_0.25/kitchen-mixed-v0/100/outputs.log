â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 05:55:45.677283
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 0d2220e93fbc0994a1ca55d9948ab02f92a57849
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 05:58:23.993153
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 0d2220e93fbc0994a1ca55d9948ab02f92a57849
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 05:59:51.005289
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 0d2220e93fbc0994a1ca55d9948ab02f92a57849
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 06:08:13.929685
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 06:08:13.960069
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/sonicbenz/Benz/course/RL/decision-diffuser/code/analysis/weights/
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 14:08:11.615614+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... âœ“
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 114, in train
    batch = next(self.dataloader)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 17, in cycle
    for data in dl:
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 671, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 133, in collate
    return elem_type(*(collate(samples, collate_fn_map=collate_fn_map) for samples in zip(*batch)))
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 133, in <genexpr>
    return elem_type(*(collate(samples, collate_fn_map=collate_fn_map) for samples in zip(*batch)))
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 163, in collate_tensor_fn
    return torch.stack(batch, 0, out=out)
RuntimeError: stack expects each tensor to be equal size, but got [100, 512] at entry 0 and [2, 512] at entry 1

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 06:08:30.285683
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 06:09:47.728394
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 06:09:47.757378
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/sonicbenz/Benz/course/RL/decision-diffuser/code/analysis/weights/
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 14:09:45.378752+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 163, in main
    batch = utils.batchify(dataset[0], Config.device)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/datasets/sequence.py", line 108, in __getitem__
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/datasets/sequence.py", line 108, in __getitem__
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 06:10:37.618441
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 06:10:54.836770
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 06:10:54.869125
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/sonicbenz/Benz/course/RL/decision-diffuser/code/analysis/weights/
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 14:10:52.473726+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... âœ“
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 114, in train
    batch = next(self.dataloader)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 17, in cycle
    for data in dl:
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 671, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 133, in collate
    return elem_type(*(collate(samples, collate_fn_map=collate_fn_map) for samples in zip(*batch)))
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 133, in <genexpr>
    return elem_type(*(collate(samples, collate_fn_map=collate_fn_map) for samples in zip(*batch)))
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 163, in collate_tensor_fn
    return torch.stack(batch, 0, out=out)
RuntimeError: stack expects each tensor to be equal size, but got [100, 512] at entry 0 and [2, 512] at entry 1

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 06:11:11.261245
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 06:12:20.003379
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 06:12:20.035776
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/sonicbenz/Benz/course/RL/decision-diffuser/code/analysis/weights/
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 14:12:17.618676+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... âœ“
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 114, in train
    batch = next(self.dataloader)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 17, in cycle
    for data in dl:
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 671, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 133, in collate
    return elem_type(*(collate(samples, collate_fn_map=collate_fn_map) for samples in zip(*batch)))
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 133, in <genexpr>
    return elem_type(*(collate(samples, collate_fn_map=collate_fn_map) for samples in zip(*batch)))
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 163, in collate_tensor_fn
    return torch.stack(batch, 0, out=out)
RuntimeError: stack expects each tensor to be equal size, but got [100, 512] at entry 0 and [2, 512] at entry 1

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 06:12:36.948681
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 06:13:34.836312
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 06:13:34.870906
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/sonicbenz/Benz/course/RL/decision-diffuser/code/analysis/weights/
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 14:13:32.456136+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... âœ“
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 114, in train
    batch = next(self.dataloader)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 17, in cycle
    for data in dl:
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 671, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 133, in collate
    return elem_type(*(collate(samples, collate_fn_map=collate_fn_map) for samples in zip(*batch)))
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 133, in <genexpr>
    return elem_type(*(collate(samples, collate_fn_map=collate_fn_map) for samples in zip(*batch)))
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 163, in collate_tensor_fn
    return torch.stack(batch, 0, out=out)
RuntimeError: stack expects each tensor to be equal size, but got [100, 512] at entry 0 and [2, 512] at entry 1

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 06:13:51.603490
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 06:14:55.443526
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 06:14:55.478653
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/sonicbenz/Benz/course/RL/decision-diffuser/code/analysis/weights/
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 14:14:53.055901+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... âœ“
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 114, in train
    batch = next(self.dataloader)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 17, in cycle
    for data in dl:
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 671, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 133, in collate
    return elem_type(*(collate(samples, collate_fn_map=collate_fn_map) for samples in zip(*batch)))
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 133, in <genexpr>
    return elem_type(*(collate(samples, collate_fn_map=collate_fn_map) for samples in zip(*batch)))
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 163, in collate_tensor_fn
    return torch.stack(batch, 0, out=out)
RuntimeError: stack expects each tensor to be equal size, but got [100, 512] at entry 0 and [2, 512] at entry 1

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 06:15:11.788218
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 06:16:39.092674
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 06:16:39.124844
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/sonicbenz/Benz/course/RL/decision-diffuser/code/analysis/weights/
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 14:16:36.721334+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... âœ“
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 114, in train
    batch = next(self.dataloader)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 17, in cycle
    for data in dl:
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 671, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 133, in collate
    return elem_type(*(collate(samples, collate_fn_map=collate_fn_map) for samples in zip(*batch)))
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 133, in <genexpr>
    return elem_type(*(collate(samples, collate_fn_map=collate_fn_map) for samples in zip(*batch)))
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 163, in collate_tensor_fn
    return torch.stack(batch, 0, out=out)
RuntimeError: stack expects each tensor to be equal size, but got [100, 512] at entry 0 and [2, 512] at entry 1

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 06:16:55.757895
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 06:17:26.649893
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 06:17:26.684746
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/sonicbenz/Benz/course/RL/decision-diffuser/code/analysis/weights/
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 14:17:24.298341+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 163, in main
    batch = utils.batchify(dataset[0], Config.device)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/arrays.py", line 62, in batchify
    val = apply_dict(fn, val) if type(val) is dict else fn(val)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/arrays.py", line 57, in <lambda>
    fn = lambda x: to_torch(x[None], device=device)
TypeError: list indices must be integers or slices, not NoneType

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 06:17:38.700119
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 06:19:32.971670
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 06:19:33.004011
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/sonicbenz/Benz/course/RL/decision-diffuser/code/analysis/weights/
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 14:19:30.654355+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... âœ“
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 114, in train
    batch = next(self.dataloader)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 17, in cycle
    for data in dl:
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 671, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 133, in collate
    return elem_type(*(collate(samples, collate_fn_map=collate_fn_map) for samples in zip(*batch)))
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 133, in <genexpr>
    return elem_type(*(collate(samples, collate_fn_map=collate_fn_map) for samples in zip(*batch)))
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/collate.py", line 163, in collate_tensor_fn
    return torch.stack(batch, 0, out=out)
RuntimeError: stack expects each tensor to be equal size, but got [100, 512] at entry 0 and [2, 512] at entry 1

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 06:19:49.321333
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 06:20:37.800354
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 06:20:37.836489
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/sonicbenz/Benz/course/RL/decision-diffuser/code/analysis/weights/
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 14:20:35.299455+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... âœ“
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 117, in train
    loss, infos = self.model.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 117, in train
    loss, infos = self.model.loss(*batch)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 06:28:06.911449
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 06:29:02.909295
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 06:29:02.945257
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/sonicbenz/Benz/course/RL/decision-diffuser/code/analysis/weights/
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 14:29:00.470156+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... âœ“
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 128, in train
    self.save()
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 162, in save
    os.makedirs(savepath, exist_ok=True)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/os.py", line 213, in makedirs
    makedirs(head, exist_ok=exist_ok)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/os.py", line 213, in makedirs
    makedirs(head, exist_ok=exist_ok)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/os.py", line 213, in makedirs
    makedirs(head, exist_ok=exist_ok)
  [Previous line repeated 11 more times]
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/os.py", line 223, in makedirs
    mkdir(name, mode)
PermissionError: [Errno 13] Permission denied: '/home/sonicbenz'

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 06:29:23.003120
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 06:29:51.842917
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 06:29:51.878557
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 14:29:49.389725+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... âœ“
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
[ utils/training ] Saved model to /home/yanyangji/research/RL/final/decision-diffuser/code/output/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100/checkpoint/state.pt
0:   0.3554 | a0_loss:   1.1496 | t:   4.0974
â•’â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¤â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â••
â”‚      a0 loss       â”‚       1.150        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       steps        â”‚         0          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        loss        â”‚       0.355        â”‚
â•˜â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•›

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 06:42:01.888315
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 06:42:01.920434
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 14:41:59.594906+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 524, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns, text_cond)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 491, in p_losses
    x_recon = self.model(x_noisy, text_cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 265, in forward
    x = resnet(x, t, c)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 110, in forward
    out = self.blocks[0](x) + self.time_mlp(t) + self.cond_mlp(cond)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/.local/lib/python3.8/site-packages/einops/layers/torch.py", line 14, in forward
    return apply_for_scriptable_torch(self._recipe, input, reduction_type='rearrange')
  File "/home/yanyangji/.local/lib/python3.8/site-packages/einops/_torch_specific.py", line 77, in apply_for_scriptable_torch
    _reconstruct_from_shape_uncached(recipe, backend.shape(tensor))
  File "/home/yanyangji/.local/lib/python3.8/site-packages/einops/einops.py", line 165, in _reconstruct_from_shape_uncached
    raise EinopsError('Expected {} dimensions, got {}'.format(len(self.input_composite_axes), len(shape)))
einops.EinopsError: Expected 2 dimensions, got 3

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 06:42:13.114689
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 06:44:55.757059
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 06:44:55.787156
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 14:44:53.477962+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 524, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns, text_cond)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 491, in p_losses
    x_recon = self.model(x_noisy, text_cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 265, in forward
    x = resnet(x, t, c)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 110, in forward
    out = self.blocks[0](x) + self.time_mlp(t) + self.cond_mlp(cond)
RuntimeError: The size of tensor a (100) must match the size of tensor b (128) at non-singleton dimension 2

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 06:45:06.937177
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 06:45:45.374216
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 06:45:45.405542
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 14:45:43.127713+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 524, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns, text_cond)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 491, in p_losses
    x_recon = self.model(x_noisy, text_cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 266, in forward
    for resnet, resnet2, downsample in self.downs:
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 111, in forward
    out = self.blocks[0](x) + self.time_mlp(t) + self.cond_mlp(cond)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 111, in forward
    out = self.blocks[0](x) + self.time_mlp(t) + self.cond_mlp(cond)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 06:47:50.069898
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 06:48:02.808700
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 06:48:02.840588
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 14:48:00.525237+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 524, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns, text_cond)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 491, in p_losses
    x_recon = self.model(x_noisy, text_cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 250, in forward
    c = self.cond_mlp(cond)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (100x60 and 512x512)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 06:48:12.389903
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 06:48:51.063443
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 06:48:51.094402
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 14:48:48.761582+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 524, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns, text_cond)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 491, in p_losses
    x_recon = self.model(x_noisy, text_cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 250, in forward
    c = self.cond_mlp(cond)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (512x100 and 512x512)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 06:49:00.542979
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 06:50:39.473996
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 06:50:39.505039
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 14:50:37.191541+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 524, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns, text_cond)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 491, in p_losses
    x_recon = self.model(x_noisy, text_cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 250, in forward
    t = self.time_mlp(time)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 250, in forward
    t = self.time_mlp(time)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 06:57:26.591944
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 06:57:34.815446
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 06:57:34.848705
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 14:57:32.449600+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 524, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns, text_cond)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 491, in p_losses
    x_recon = self.model(x_noisy, text_cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 268, in forward
    x = resnet(x, t, c)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 113, in forward
    out = self.blocks[0](x) + self.time_mlp(t) + text_cond
RuntimeError: The size of tensor a (50) must match the size of tensor b (100) at non-singleton dimension 2

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 06:57:46.565265
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 07:01:01.726412
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 07:01:01.759598
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 15:00:59.455158+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 524, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns, text_cond)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 491, in p_losses
    x_recon = self.model(x_noisy, text_cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 269, in forward
    x = resnet(x, t, c)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 114, in forward
    out = self.blocks[0](x) + self.time_mlp(t) + text_cond
RuntimeError: The size of tensor a (100) must match the size of tensor b (128) at non-singleton dimension 2

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 07:01:12.880405
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 07:02:56.244883
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 07:02:56.277389
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 15:02:53.964203+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 524, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns, text_cond)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 491, in p_losses
    x_recon = self.model(x_noisy, text_cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 256, in forward
    if self.returns_condition:
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 114, in forward
    out = self.blocks[0](x) + self.time_mlp(t) + text_cond
RuntimeError: The size of tensor a (100) must match the size of tensor b (128) at non-singleton dimension 2

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 07:03:38.755624
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 07:04:07.767709
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 07:04:07.800676
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 15:04:05.459206+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 524, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns, text_cond)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 491, in p_losses
    x_recon = self.model(x_noisy, text_cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 256, in forward
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 256, in forward
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 07:08:08.758380
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 07:08:16.163512
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 07:08:16.199164
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 15:08:13.756375+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 07:08:26.652307
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 07:08:26.688424
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 15:08:24.161303+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 524, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns, text_cond)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 491, in p_losses
    x_recon = self.model(x_noisy, text_cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 269, in forward
    h.append(x)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 114, in forward
    # breakpoint()
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 114, in forward
    # breakpoint()
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 07:11:02.122902
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 07:11:12.048613
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 07:11:12.084273
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 15:11:09.732061+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 524, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns, text_cond)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 491, in p_losses
    x_recon = self.model(x_noisy, text_cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 267, in forward
    x = resnet(x, t, c)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 113, in forward
    out = self.blocks[0](x) + self.time_mlp(t) + text_cond
RuntimeError: The size of tensor a (50) must match the size of tensor b (100) at non-singleton dimension 2

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 07:11:23.383478
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 07:11:50.664731
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 07:11:50.701548
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 15:11:48.268160+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 524, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns, text_cond)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 491, in p_losses
    x_recon = self.model(x_noisy, text_cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 267, in forward
    x = resnet(x, t, c)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 113, in forward
    out = self.blocks[0](x) + self.time_mlp(t) + text_cond
RuntimeError: The size of tensor a (50) must match the size of tensor b (100) at non-singleton dimension 2

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 07:12:02.002269
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 07:20:13.430619
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 07:20:13.465563
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 15:20:11.080314+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 07:20:26.133351
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 1ad33c383960e1d0504c3efa1efcccffd3352560
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 07:20:26.168763
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 15:20:23.829920+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... âœ“
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
[ utils/training ] Saved model to /home/yanyangji/research/RL/final/decision-diffuser/code/output/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100/checkpoint/state.pt
0:   0.3712 | a0_loss:   1.1803 | t:   4.4369
â•’â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¤â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â••
â”‚      a0 loss       â”‚       1.180        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       steps        â”‚         0          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        loss        â”‚       0.371        â”‚
â•˜â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•›

Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 143, in train
    self.inv_render_samples()
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 300, in inv_render_samples
    samples = self.ema_model.conditional_sample(conditions, returns=returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 471, in conditional_sample
    return self.p_sample_loop(shape, cond, returns, *args, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 447, in p_sample_loop
    x = self.p_sample(x, cond, timesteps, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 428, in p_sample
    model_mean, _, model_log_variance = self.p_mean_variance(x=x, cond=cond, t=t, returns=returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 407, in p_mean_variance
    epsilon_cond = self.model(x, cond, t, returns, use_dropout=False)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 251, in forward
    c = self.cond_mlp(cond)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
TypeError: linear(): argument 'input' (position 1) must be Tensor, not dict

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 07:20:48.175918
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
