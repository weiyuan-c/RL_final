══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       │ created             
     createTime     │ 2023-12-06 03:53:02.180848
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ cb00c13da6758f91b8211d27e6747c84964e0416
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-06 03:53:02.222782
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-06 11:53:00.021335+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 49, in main
    dataset = dataset_config()
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/config.py", line 65, in __call__
    instance = self._class(*args, **kwargs, **self._dict)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/datasets/sequence.py", line 33, in __init__
    for i, episode in enumerate(itr):
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/datasets/d4rl.py", line 113, in sequence_dataset
    target_task = list(env.tasks_to_complete)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/d4rl/utils/wrappers.py", line 43, in __getattr__
    return getattr(self._wrapped_env, attr)
AttributeError: 'OfflineHopperEnv' object has no attribute 'tasks_to_complete'

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-06 03:53:04.281554
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       │ created             
     createTime     │ 2023-12-06 03:55:25.396063
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ cb00c13da6758f91b8211d27e6747c84964e0416
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ kitchen-mixed-v0    
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-06 03:55:25.440162
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ kitchen-mixed-v0    
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-06 11:55:23.192080+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 163, in main
    batch = utils.batchify(dataset[0], Config.device)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/arrays.py", line 62, in batchify
    val = apply_dict(fn, val) if type(val) is dict else fn(val)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/arrays.py", line 57, in <lambda>
    fn = lambda x: to_torch(x[None], device=device)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/arrays.py", line 26, in to_torch
    return torch.tensor(x, dtype=dtype, device=device)
TypeError: can't convert np.ndarray of type numpy.object_. The only supported types are: float64, float32, float16, complex64, complex128, int64, int32, int16, int8, uint8, and bool.

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-06 03:56:12.060075
════════════════════╧═════════════════════
