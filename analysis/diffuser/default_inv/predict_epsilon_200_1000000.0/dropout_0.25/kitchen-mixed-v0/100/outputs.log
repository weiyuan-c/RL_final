â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 03:53:02.180848
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ cb00c13da6758f91b8211d27e6747c84964e0416
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ hopper-medium-expert-v2
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 03:53:02.222782
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       â”‚ hopper-medium-expert-v2
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 11:53:00.021335+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 49, in main
    dataset = dataset_config()
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/config.py", line 65, in __call__
    instance = self._class(*args, **kwargs, **self._dict)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/datasets/sequence.py", line 33, in __init__
    for i, episode in enumerate(itr):
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/datasets/d4rl.py", line 113, in sequence_dataset
    target_task = list(env.tasks_to_complete)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/d4rl/utils/wrappers.py", line 43, in __getattr__
    return getattr(self._wrapped_env, attr)
AttributeError: 'OfflineHopperEnv' object has no attribute 'tasks_to_complete'

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 03:53:04.281554
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       â”‚ created             
     createTime     â”‚ 2023-12-06 03:55:25.396063
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ cb00c13da6758f91b8211d27e6747c84964e0416
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ main                
        doc         â”‚ None                
       module       â”‚ scripts.train       
        file        â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        â”‚ 100                 
 returns_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 200                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianInvDynDiffusion
   n_train_steps    â”‚ 1000000.0           
      dataset       â”‚ kitchen-mixed-v0    
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-12-06 03:55:25.440162
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ vll-weiyuan         
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 100                 
       device       â”‚ cuda                
       bucket       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       â”‚ kitchen-mixed-v0    
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianInvDynDiffusion
      horizon       â”‚ 100                 
 n_diffusion_steps  â”‚ 200                 
   action_weight    â”‚ 10                  
    loss_weights    â”‚ None                
   loss_discount    â”‚ 1                   
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ True                
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
       loader       â”‚ datasets.SequenceDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 1000000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      â”‚ yanyangji           
      project       â”‚ diffuser            
    script_root     â”‚ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-12-06 11:55:23.192080+08:00
       prefix       â”‚ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      â”‚ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ train               
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 163, in main
    batch = utils.batchify(dataset[0], Config.device)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/arrays.py", line 62, in batchify
    val = apply_dict(fn, val) if type(val) is dict else fn(val)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/arrays.py", line 57, in <lambda>
    fn = lambda x: to_torch(x[None], device=device)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/arrays.py", line 26, in to_torch
    return torch.tensor(x, dtype=dtype, device=device)
TypeError: can't convert np.ndarray of type numpy.object_. The only supported types are: float64, float32, float16, complex64, complex128, int64, int32, int16, int8, uint8, and bool.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-12-06 03:56:12.060075
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
