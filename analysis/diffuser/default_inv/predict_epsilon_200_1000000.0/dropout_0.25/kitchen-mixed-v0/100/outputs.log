══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       │ created             
     createTime     │ 2023-12-06 07:38:20.695428
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ d90c085e279d274b4511f22fca14dd459c9857ad
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ kitchen-mixed-v0    
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-06 07:38:20.730480
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ sonicbenz-vll       
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ kitchen-mixed-v0    
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      username      │ sonicbenz           
      project       │ diffuser            
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
    script_path     │ None                
        now         │ 2023-12-06 15:38:19.442671+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ analysis/train      
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
Traceback (most recent call last):
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/utils/training.py", line 114, in train
    batch = next(self.dataloader)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/utils/training.py", line 17, in cycle
    for data in dl:
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 561, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/datasets/sequence.py", line 105, in __getitem__
    text_cond = self.clip.encode_text(text_cond)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/clip/model.py", line 348, in encode_text
    x = self.transformer(x)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/clip/model.py", line 203, in forward
    return self.resblocks(x)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/clip/model.py", line 190, in forward
    x = x + self.attention(self.ln_1(x))
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/clip/model.py", line 187, in attention
    return self.attn(x, x, x, need_weights=False, attn_mask=self.attn_mask)[0]
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/activation.py", line 1031, in forward
    attn_output, attn_output_weights = F.multi_head_attention_forward(
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/functional.py", line 5025, in multi_head_attention_forward
    k = k.contiguous().view(-1, bsz * num_heads, head_dim).transpose(0, 1)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0, 64] because the unspecified dimension size -1 can be any value and is ambiguous

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-06 07:38:29.621816
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       │ created             
     createTime     │ 2023-12-06 07:40:16.421192
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ d90c085e279d274b4511f22fca14dd459c9857ad
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ kitchen-mixed-v0    
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-06 07:40:16.451422
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ sonicbenz-vll       
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ kitchen-mixed-v0    
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      username      │ sonicbenz           
      project       │ diffuser            
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
    script_path     │ None                
        now         │ 2023-12-06 15:40:15.175984+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ analysis/train      
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
Traceback (most recent call last):
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/utils/training.py", line 114, in train
    batch = next(self.dataloader)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/utils/training.py", line 17, in cycle
    for data in dl:
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 561, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/datasets/sequence.py", line 107, in __getitem__
    text_cond = self.clip.encode_text(text_cond)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/clip/model.py", line 348, in encode_text
    x = self.transformer(x)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/clip/model.py", line 203, in forward
    return self.resblocks(x)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/clip/model.py", line 190, in forward
    x = x + self.attention(self.ln_1(x))
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/clip/model.py", line 187, in attention
    return self.attn(x, x, x, need_weights=False, attn_mask=self.attn_mask)[0]
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/activation.py", line 1031, in forward
    attn_output, attn_output_weights = F.multi_head_attention_forward(
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/functional.py", line 5025, in multi_head_attention_forward
    k = k.contiguous().view(-1, bsz * num_heads, head_dim).transpose(0, 1)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0, 64] because the unspecified dimension size -1 can be any value and is ambiguous

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-06 07:40:25.045499
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       │ created             
     createTime     │ 2023-12-06 07:41:26.240909
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ d90c085e279d274b4511f22fca14dd459c9857ad
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ kitchen-mixed-v0    
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-06 07:41:26.270937
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ sonicbenz-vll       
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ kitchen-mixed-v0    
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      username      │ sonicbenz           
      project       │ diffuser            
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
    script_path     │ None                
        now         │ 2023-12-06 15:41:25.009777+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ analysis/train      
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py", line 163, in main
    batch = utils.batchify(dataset[0], Config.device)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/datasets/sequence.py", line 104, in __getitem__
    print(text_cond.shape)
AttributeError: 'list' object has no attribute 'shape'

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-06 07:41:32.942950
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       │ created             
     createTime     │ 2023-12-06 07:43:36.107492
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ d90c085e279d274b4511f22fca14dd459c9857ad
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ kitchen-mixed-v0    
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-06 07:43:36.131569
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ sonicbenz-vll       
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ kitchen-mixed-v0    
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      username      │ sonicbenz           
      project       │ diffuser            
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
    script_path     │ None                
        now         │ 2023-12-06 15:43:34.897947+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ analysis/train      
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
Traceback (most recent call last):
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/utils/training.py", line 114, in train
    batch = next(self.dataloader)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/utils/training.py", line 17, in cycle
    for data in dl:
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 561, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/datasets/sequence.py", line 107, in __getitem__
    text_cond = self.clip.encode_text(text_cond)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/clip/model.py", line 348, in encode_text
    x = self.transformer(x)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/clip/model.py", line 203, in forward
    return self.resblocks(x)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/clip/model.py", line 190, in forward
    x = x + self.attention(self.ln_1(x))
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/clip/model.py", line 187, in attention
    return self.attn(x, x, x, need_weights=False, attn_mask=self.attn_mask)[0]
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/activation.py", line 1031, in forward
    attn_output, attn_output_weights = F.multi_head_attention_forward(
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/functional.py", line 5025, in multi_head_attention_forward
    k = k.contiguous().view(-1, bsz * num_heads, head_dim).transpose(0, 1)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0, 64] because the unspecified dimension size -1 can be any value and is ambiguous

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-06 07:43:44.741577
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       │ created             
     createTime     │ 2023-12-06 07:45:21.040267
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ d90c085e279d274b4511f22fca14dd459c9857ad
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ kitchen-mixed-v0    
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-06 07:45:21.068830
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ sonicbenz-vll       
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ kitchen-mixed-v0    
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      username      │ sonicbenz           
      project       │ diffuser            
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
    script_path     │ None                
        now         │ 2023-12-06 15:45:19.837592+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ analysis/train      
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       │ created             
     createTime     │ 2023-12-06 07:45:27.158312
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ d90c085e279d274b4511f22fca14dd459c9857ad
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ kitchen-mixed-v0    
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-06 07:45:27.183069
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ sonicbenz-vll       
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ kitchen-mixed-v0    
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      username      │ sonicbenz           
      project       │ diffuser            
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
    script_path     │ None                
        now         │ 2023-12-06 15:45:25.927624+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ analysis/train      
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
Traceback (most recent call last):
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/utils/training.py", line 114, in train
    batch = next(self.dataloader)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/utils/training.py", line 17, in cycle
    for data in dl:
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 561, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/datasets/sequence.py", line 108, in __getitem__
    text_cond = self.clip.encode_text(text_cond)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/clip/model.py", line 348, in encode_text
    x = self.transformer(x)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/clip/model.py", line 203, in forward
    return self.resblocks(x)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/clip/model.py", line 190, in forward
    x = x + self.attention(self.ln_1(x))
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/clip/model.py", line 187, in attention
    return self.attn(x, x, x, need_weights=False, attn_mask=self.attn_mask)[0]
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/activation.py", line 1031, in forward
    attn_output, attn_output_weights = F.multi_head_attention_forward(
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/functional.py", line 5025, in multi_head_attention_forward
    k = k.contiguous().view(-1, bsz * num_heads, head_dim).transpose(0, 1)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0, 64] because the unspecified dimension size -1 can be any value and is ambiguous

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-06 07:45:35.797928
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       │ created             
     createTime     │ 2023-12-06 07:46:06.781048
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ d90c085e279d274b4511f22fca14dd459c9857ad
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ kitchen-mixed-v0    
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-06 07:46:06.819520
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ sonicbenz-vll       
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ kitchen-mixed-v0    
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      username      │ sonicbenz           
      project       │ diffuser            
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
    script_path     │ None                
        now         │ 2023-12-06 15:46:05.554425+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ analysis/train      
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
Traceback (most recent call last):
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/utils/training.py", line 114, in train
    batch = next(self.dataloader)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/utils/training.py", line 17, in cycle
    for data in dl:
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 561, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/datasets/sequence.py", line 109, in __getitem__
    text_cond = self.clip.encode_text(text_cond)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/clip/model.py", line 348, in encode_text
    x = self.transformer(x)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/clip/model.py", line 203, in forward
    return self.resblocks(x)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/clip/model.py", line 190, in forward
    x = x + self.attention(self.ln_1(x))
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/clip/model.py", line 187, in attention
    return self.attn(x, x, x, need_weights=False, attn_mask=self.attn_mask)[0]
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/activation.py", line 1031, in forward
    attn_output, attn_output_weights = F.multi_head_attention_forward(
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/functional.py", line 5025, in multi_head_attention_forward
    k = k.contiguous().view(-1, bsz * num_heads, head_dim).transpose(0, 1)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0, 64] because the unspecified dimension size -1 can be any value and is ambiguous

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-06 07:46:15.383761
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       │ created             
     createTime     │ 2023-12-06 07:50:39.019830
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ d90c085e279d274b4511f22fca14dd459c9857ad
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ kitchen-mixed-v0    
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-06 07:50:39.044376
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ sonicbenz-vll       
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ kitchen-mixed-v0    
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      username      │ sonicbenz           
      project       │ diffuser            
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
    script_path     │ None                
        now         │ 2023-12-06 15:50:37.751668+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ analysis/train      
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
Traceback (most recent call last):
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/utils/training.py", line 128, in train
    self.save()
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/utils/training.py", line 162, in save
    os.makedirs(savepath, exist_ok=True)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/os.py", line 213, in makedirs
    makedirs(head, exist_ok=exist_ok)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/os.py", line 213, in makedirs
    makedirs(head, exist_ok=exist_ok)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/os.py", line 213, in makedirs
    makedirs(head, exist_ok=exist_ok)
  [Previous line repeated 10 more times]
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/os.py", line 223, in makedirs
    mkdir(name, mode)
PermissionError: [Errno 13] Permission denied: '/home/yanyangji'

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-06 07:50:51.175045
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       │ created             
     createTime     │ 2023-12-06 07:53:02.358453
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ d90c085e279d274b4511f22fca14dd459c9857ad
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ kitchen-mixed-v0    
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-06 07:53:02.382733
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ sonicbenz-vll       
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/sonicbenz/Benz/course/RL/RL_final/analysis/weights
      dataset       │ kitchen-mixed-v0    
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      username      │ sonicbenz           
      project       │ diffuser            
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
    script_path     │ None                
        now         │ 2023-12-06 15:53:01.186827+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ analysis/train      
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
[ utils/training ] Saved model to /home/sonicbenz/Benz/course/RL/RL_final/analysis/weights/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100/checkpoint/state.pt
0:   0.3712 | a0_loss:   1.1803 | t:   3.8293
╒════════════════════╤════════════════════╕
│      a0 loss       │       1.180        │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.371        │
╘════════════════════╧════════════════════╛

Traceback (most recent call last):
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/utils/training.py", line 143, in train
    self.inv_render_samples()
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/utils/training.py", line 300, in inv_render_samples
    samples = self.ema_model.conditional_sample(conditions, returns=returns)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 28, in decorate_context
    return func(*args, **kwargs)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/diffusion.py", line 471, in conditional_sample
    return self.p_sample_loop(shape, cond, returns, *args, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 28, in decorate_context
    return func(*args, **kwargs)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/diffusion.py", line 447, in p_sample_loop
    x = self.p_sample(x, cond, timesteps, returns)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 28, in decorate_context
    return func(*args, **kwargs)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/diffusion.py", line 428, in p_sample
    model_mean, _, model_log_variance = self.p_mean_variance(x=x, cond=cond, t=t, returns=returns)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/diffusion.py", line 407, in p_mean_variance
    epsilon_cond = self.model(x, cond, t, returns, use_dropout=False)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/temporal.py", line 250, in forward
    c = self.cond_mlp(cond)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 96, in forward
    return F.linear(input, self.weight, self.bias)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/functional.py", line 1847, in linear
    return torch._C._nn.linear(input, weight, bias)
TypeError: linear(): argument 'input' (position 1) must be Tensor, not dict

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-06 07:53:18.517688
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       │ created             
     createTime     │ 2023-12-06 08:03:32.770971
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ d90c085e279d274b4511f22fca14dd459c9857ad
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ kitchen-mixed-v0    
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-06 08:03:32.799991
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ sonicbenz-vll       
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/sonicbenz/Benz/course/RL/RL_final/analysis/weights
      dataset       │ kitchen-mixed-v0    
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      username      │ sonicbenz           
      project       │ diffuser            
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
    script_path     │ None                
        now         │ 2023-12-06 16:03:31.530719+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ analysis/train      
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
[ utils/training ] Saved model to /home/sonicbenz/Benz/course/RL/RL_final/analysis/weights/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100/checkpoint/state.pt
0:   0.3712 | a0_loss:   1.1803 | t:   4.2023
╒════════════════════╤════════════════════╕
│      a0 loss       │       1.180        │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.371        │
╘════════════════════╧════════════════════╛

Traceback (most recent call last):
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/utils/training.py", line 143, in train
    self.inv_render_samples()
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/utils/training.py", line 300, in inv_render_samples
    samples = self.ema_model.conditional_sample(conditions, returns=returns)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 28, in decorate_context
    return func(*args, **kwargs)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/diffusion.py", line 472, in conditional_sample
    return self.p_sample_loop(shape, cond, returns, *args, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 28, in decorate_context
    return func(*args, **kwargs)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/diffusion.py", line 448, in p_sample_loop
    x = self.p_sample(x, cond, timesteps, returns)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 28, in decorate_context
    return func(*args, **kwargs)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/diffusion.py", line 428, in p_sample
    model_mean, _, model_log_variance = self.p_mean_variance(x=x, cond=cond, t=t, returns=returns)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/diffusion.py", line 407, in p_mean_variance
    epsilon_cond = self.model(x, cond, t, returns, use_dropout=False)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/temporal.py", line 250, in forward
    c = self.cond_mlp(cond)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 96, in forward
    return F.linear(input, self.weight, self.bias)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/functional.py", line 1847, in linear
    return torch._C._nn.linear(input, weight, bias)
TypeError: linear(): argument 'input' (position 1) must be Tensor, not dict

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-06 08:03:49.001351
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       │ created             
     createTime     │ 2023-12-06 09:06:48.958915
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ d90c085e279d274b4511f22fca14dd459c9857ad
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ kitchen-mixed-v0    
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-06 09:06:48.981500
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ sonicbenz-vll       
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/sonicbenz/Benz/course/RL/RL_final/analysis/weights
      dataset       │ kitchen-mixed-v0    
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      username      │ sonicbenz           
      project       │ diffuser            
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
    script_path     │ None                
        now         │ 2023-12-06 17:06:47.728902+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ analysis/train      
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
[ utils/training ] Saved model to /home/sonicbenz/Benz/course/RL/RL_final/analysis/weights/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100/checkpoint/state.pt
0:   0.3714 | a0_loss:   1.1810 | t:   4.1475
╒════════════════════╤════════════════════╕
│      a0 loss       │       1.181        │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.371        │
╘════════════════════╧════════════════════╛

Traceback (most recent call last):
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/utils/training.py", line 143, in train
    self.inv_render_samples()
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/utils/training.py", line 301, in inv_render_samples
    samples = self.ema_model.conditional_sample(conditions, returns=returns, text_cond=text_cond)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 28, in decorate_context
    return func(*args, **kwargs)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/diffusion.py", line 472, in conditional_sample
    return self.p_sample_loop(shape, cond, returns, text_cond, *args, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 28, in decorate_context
    return func(*args, **kwargs)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/diffusion.py", line 448, in p_sample_loop
    x = self.p_sample(x, cond, timesteps, returns, text_cond)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 28, in decorate_context
    return func(*args, **kwargs)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/diffusion.py", line 428, in p_sample
    model_mean, _, model_log_variance = self.p_mean_variance(x=x, cond=cond, t=t, returns=returns, text_cond=text_cond)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/diffusion.py", line 407, in p_mean_variance
    epsilon_cond = self.model(x, cond, t, returns, use_dropout=False)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/temporal.py", line 250, in forward
    c = self.cond_mlp(cond)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 96, in forward
    return F.linear(input, self.weight, self.bias)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/functional.py", line 1847, in linear
    return torch._C._nn.linear(input, weight, bias)
TypeError: linear(): argument 'input' (position 1) must be Tensor, not dict

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-06 09:07:05.040296
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       │ created             
     createTime     │ 2023-12-06 09:11:45.641841
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ d90c085e279d274b4511f22fca14dd459c9857ad
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ kitchen-mixed-v0    
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-06 09:11:45.668091
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ sonicbenz-vll       
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/sonicbenz/Benz/course/RL/RL_final/analysis/weights
      dataset       │ kitchen-mixed-v0    
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      username      │ sonicbenz           
      project       │ diffuser            
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
    script_path     │ None                
        now         │ 2023-12-06 17:11:44.378142+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ analysis/train      
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
[ utils/training ] Saved model to /home/sonicbenz/Benz/course/RL/RL_final/analysis/weights/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100/checkpoint/state.pt
0:   0.3714 | a0_loss:   1.1810 | t:   4.1596
╒════════════════════╤════════════════════╕
│      a0 loss       │       1.181        │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.371        │
╘════════════════════╧════════════════════╛

Traceback (most recent call last):
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/utils/training.py", line 143, in train
    self.inv_render_samples()
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/utils/training.py", line 301, in inv_render_samples
    samples = self.ema_model.conditional_sample(conditions, returns=returns, text_cond=text_cond)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 28, in decorate_context
    return func(*args, **kwargs)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/diffusion.py", line 472, in conditional_sample
    return self.p_sample_loop(shape, cond, returns, text_cond, *args, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 28, in decorate_context
    return func(*args, **kwargs)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/diffusion.py", line 448, in p_sample_loop
    x = self.p_sample(x, cond, timesteps, returns, text_cond)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 28, in decorate_context
    return func(*args, **kwargs)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/diffusion.py", line 428, in p_sample
    model_mean, _, model_log_variance = self.p_mean_variance(x=x, cond=cond, t=t, returns=returns, text_cond=text_cond)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/diffusion.py", line 407, in p_mean_variance
    epsilon_cond = self.model(x, cond, t, returns, text_cond, use_dropout=False)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
TypeError: forward() got multiple values for argument 'use_dropout'

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-06 09:12:01.762872
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       │ created             
     createTime     │ 2023-12-06 09:12:38.806294
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ d90c085e279d274b4511f22fca14dd459c9857ad
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ kitchen-mixed-v0    
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-06 09:12:38.832692
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ sonicbenz-vll       
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/sonicbenz/Benz/course/RL/RL_final/analysis/weights
      dataset       │ kitchen-mixed-v0    
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      username      │ sonicbenz           
      project       │ diffuser            
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
    script_path     │ None                
        now         │ 2023-12-06 17:12:37.583522+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ analysis/train      
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
[ utils/training ] Saved model to /home/sonicbenz/Benz/course/RL/RL_final/analysis/weights/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100/checkpoint/state.pt
0:   0.3714 | a0_loss:   1.1810 | t:   4.0584
╒════════════════════╤════════════════════╕
│      a0 loss       │       1.181        │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.371        │
╘════════════════════╧════════════════════╛

Traceback (most recent call last):
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/utils/training.py", line 143, in train
    self.inv_render_samples()
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/utils/training.py", line 301, in inv_render_samples
    samples = self.ema_model.conditional_sample(conditions, returns=returns, text_cond=text_cond)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 28, in decorate_context
    return func(*args, **kwargs)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/diffusion.py", line 472, in conditional_sample
    return self.p_sample_loop(shape, cond, returns, text_cond, *args, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 28, in decorate_context
    return func(*args, **kwargs)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/diffusion.py", line 448, in p_sample_loop
    x = self.p_sample(x, cond, timesteps, returns, text_cond)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 28, in decorate_context
    return func(*args, **kwargs)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/diffusion.py", line 428, in p_sample
    model_mean, _, model_log_variance = self.p_mean_variance(x=x, cond=cond, t=t, returns=returns, text_cond=text_cond)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/diffusion.py", line 407, in p_mean_variance
    epsilon_cond = self.model(x, text_cond, t, returns, use_dropout=False)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/temporal.py", line 250, in forward
    c = self.cond_mlp(cond)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 96, in forward
    return F.linear(input, self.weight, self.bias)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/functional.py", line 1847, in linear
    return torch._C._nn.linear(input, weight, bias)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking arugment for argument mat2 in method wrapper_mm)

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-06 09:12:54.781778
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       │ created             
     createTime     │ 2023-12-06 09:17:36.388427
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ d90c085e279d274b4511f22fca14dd459c9857ad
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ kitchen-mixed-v0    
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-06 09:17:36.412506
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ sonicbenz-vll       
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/sonicbenz/Benz/course/RL/RL_final/analysis/weights
      dataset       │ kitchen-mixed-v0    
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      username      │ sonicbenz           
      project       │ diffuser            
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
    script_path     │ None                
        now         │ 2023-12-06 17:17:35.147693+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ analysis/train      
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/diffusion.py", line 525, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns, text_cond)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/diffusion.py", line 492, in p_losses
    x_recon = self.model(x_noisy, text_cond, t, returns)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/temporal.py", line 267, in forward
    x = resnet(x, t, c)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/temporal.py", line 112, in forward
    out = self.blocks[0](x) + self.time_mlp(t) + text_cond
RuntimeError: The size of tensor a (50) must match the size of tensor b (100) at non-singleton dimension 2

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-06 09:17:43.208074
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
       status       │ created             
     createTime     │ 2023-12-06 09:21:50.124963
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ d90c085e279d274b4511f22fca14dd459c9857ad
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ kitchen-mixed-v0    
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-06 09:21:50.148014
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ sonicbenz-vll       
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/sonicbenz/Benz/course/RL/RL_final/analysis/weights
      dataset       │ kitchen-mixed-v0    
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
      username      │ sonicbenz           
      project       │ diffuser            
    script_root     │ /home/sonicbenz/Benz/course/RL/RL_final/analysis
    script_path     │ None                
        now         │ 2023-12-06 17:21:48.893639+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/kitchen-mixed-v0/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ analysis/train      
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/sonicbenz/Benz/course/RL/RL_final/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/diffusion.py", line 525, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns, text_cond)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/diffusion.py", line 492, in p_losses
    x_recon = self.model(x_noisy, text_cond, t, returns)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/temporal.py", line 269, in forward
    x = resnet(x, t, c)
  File "/home/sonicbenz/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/sonicbenz/Benz/course/RL/RL_final/diffuser/models/temporal.py", line 114, in forward
    out = self.blocks[0](x) + self.time_mlp(t) + text_cond
RuntimeError: The size of tensor a (50) must match the size of tensor b (100) at non-singleton dimension 2

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-06 09:21:56.865151
════════════════════╧═════════════════════
