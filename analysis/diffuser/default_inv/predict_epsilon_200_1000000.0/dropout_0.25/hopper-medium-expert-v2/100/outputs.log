══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-03 06:08:57.857159
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-03 06:08:58.289586
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/aajay/weights/
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-03 14:08:55.960586+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 175, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 127, in train
    self.save()
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 161, in save
    os.makedirs(savepath, exist_ok=True)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/os.py", line 213, in makedirs
    makedirs(head, exist_ok=exist_ok)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/os.py", line 213, in makedirs
    makedirs(head, exist_ok=exist_ok)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/os.py", line 213, in makedirs
    makedirs(head, exist_ok=exist_ok)
  [Previous line repeated 5 more times]
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/os.py", line 223, in makedirs
    mkdir(name, mode)
PermissionError: [Errno 13] Permission denied: '/home/aajay'

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-03 06:09:59.660719
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-03 06:15:42.007453
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-03 06:15:42.409366
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-03 14:15:40.181180+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
[ utils/training ] Saved model to /home/yanyangji/research/RL/final/decision-diffuser/code/output/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100/checkpoint/state.pt
0:   0.3721 | a0_loss:   1.1658 | t:   3.7302
╒════════════════════╤════════════════════╕
│      a0 loss       │       1.166        │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.372        │
╘════════════════════╧════════════════════╛

1000:   0.0322 | a0_loss:   0.0935 | t:  83.4232
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.093        │
├────────────────────┼────────────────────┤
│       steps        │        1000        │
├────────────────────┼────────────────────┤
│        loss        │       0.032        │
╘════════════════════╧════════════════════╛

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-03 06:32:56.834845
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-03 06:32:57.218597
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-03 14:32:55.018302+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
[ utils/training ] Saved model to /home/yanyangji/research/RL/final/decision-diffuser/code/output/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100/checkpoint/state.pt
0:   0.3721 | a0_loss:   1.1658 | t:   4.0601
╒════════════════════╤════════════════════╕
│      a0 loss       │       1.166        │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.372        │
╘════════════════════╧════════════════════╛

1000:   0.0324 | a0_loss:   0.0940 | t:  85.1248
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.094        │
├────────────────────┼────────────────────┤
│       steps        │        1000        │
├────────────────────┼────────────────────┤
│        loss        │       0.032        │
╘════════════════════╧════════════════════╛

2000:   0.0188 | a0_loss:   0.0494 | t:  72.3575
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.049        │
├────────────────────┼────────────────────┤
│       steps        │        2000        │
├────────────────────┼────────────────────┤
│        loss        │       0.019        │
╘════════════════════╧════════════════════╛

3000:   0.0154 | a0_loss:   0.0407 | t:  73.9738
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.041        │
├────────────────────┼────────────────────┤
│       steps        │        3000        │
├────────────────────┼────────────────────┤
│        loss        │       0.015        │
╘════════════════════╧════════════════════╛

4000:   0.0171 | a0_loss:   0.0506 | t:  72.9829
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.051        │
├────────────────────┼────────────────────┤
│       steps        │        4000        │
├────────────────────┼────────────────────┤
│        loss        │       0.017        │
╘════════════════════╧════════════════════╛

5000:   0.0218 | a0_loss:   0.0709 | t:  71.6663
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.071        │
├────────────────────┼────────────────────┤
│       steps        │        5000        │
├────────────────────┼────────────────────┤
│        loss        │       0.022        │
╘════════════════════╧════════════════════╛

6000:   0.0198 | a0_loss:   0.0624 | t:  74.1532
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.062        │
├────────────────────┼────────────────────┤
│       steps        │        6000        │
├────────────────────┼────────────────────┤
│        loss        │       0.020        │
╘════════════════════╧════════════════════╛

7000:   0.0221 | a0_loss:   0.0721 | t:  73.5418
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.072        │
├────────────────────┼────────────────────┤
│       steps        │        7000        │
├────────────────────┼────────────────────┤
│        loss        │       0.022        │
╘════════════════════╧════════════════════╛

8000:   0.0138 | a0_loss:   0.0400 | t:  72.2670
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.040        │
├────────────────────┼────────────────────┤
│       steps        │        8000        │
├────────────────────┼────────────────────┤
│        loss        │       0.014        │
╘════════════════════╧════════════════════╛

9000:   0.0132 | a0_loss:   0.0396 | t:  74.9672
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.040        │
├────────────────────┼────────────────────┤
│       steps        │        9000        │
├────────────────────┼────────────────────┤
│        loss        │       0.013        │
╘════════════════════╧════════════════════╛

Epoch 1 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
[ utils/training ] Saved model to /home/yanyangji/research/RL/final/decision-diffuser/code/output/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100/checkpoint/state.pt
10000:   0.0130 | a0_loss:   0.0384 | t:   0.8531
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.038        │
├────────────────────┼────────────────────┤
│       steps        │       10000        │
├────────────────────┼────────────────────┤
│        loss        │       0.013        │
╘════════════════════╧════════════════════╛

11000:   0.0132 | a0_loss:   0.0407 | t:  85.0105
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.041        │
├────────────────────┼────────────────────┤
│       steps        │       11000        │
├────────────────────┼────────────────────┤
│        loss        │       0.013        │
╘════════════════════╧════════════════════╛

12000:   0.0134 | a0_loss:   0.0415 | t:  71.9221
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.042        │
├────────────────────┼────────────────────┤
│       steps        │       12000        │
├────────────────────┼────────────────────┤
│        loss        │       0.013        │
╘════════════════════╧════════════════════╛

13000:   0.0136 | a0_loss:   0.0427 | t:  71.3913
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.043        │
├────────────────────┼────────────────────┤
│       steps        │       13000        │
├────────────────────┼────────────────────┤
│        loss        │       0.014        │
╘════════════════════╧════════════════════╛

14000:   0.0134 | a0_loss:   0.0407 | t:  72.1518
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.041        │
├────────────────────┼────────────────────┤
│       steps        │       14000        │
├────────────────────┼────────────────────┤
│        loss        │       0.013        │
╘════════════════════╧════════════════════╛

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-04 07:33:35.104224
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-04 07:33:35.977367
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-04 15:33:31.455084+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-04 07:35:40.436837
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-04 07:35:40.468506
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-04 15:35:38.101437+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-04 07:47:32.891177
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-04 07:47:32.923521
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-04 15:47:30.586361+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... ══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-04 07:50:53.801825
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-04 07:50:53.833377
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-04 15:50:51.543736+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 151, in main
    diffusion = diffusion_config(model)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/config.py", line 65, in __call__
    instance = self._class(*args, **kwargs, **self._dict)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 308, in __init__
    self.inv_model = nn.Sequential(
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 308, in __init__
    self.inv_model = nn.Sequential(
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-04 07:52:12.373474
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-04 08:19:09.833808
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-04 08:19:09.863700
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.MLPnet       
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-04 16:19:07.594081+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 163, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 523, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 490, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 369, in forward
    inp = torch.cat([t, cond, x], dim=-1)
TypeError: expected Tensor as element 1 in argument 0, but got dict

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-04 08:19:39.484338
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-04 11:06:43.136620
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-04 11:06:43.161341
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.MLPnet       
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-04 19:06:41.030218+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 151, in main
    diffusion = diffusion_config(model)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/config.py", line 65, in __call__
    instance = self._class(*args, **kwargs, **self._dict)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 307, in __init__
    device = self.model.device
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1265, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'MLPnet' object has no attribute 'device'

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-04 11:07:10.700717
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-04 11:09:50.054089
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-04 11:09:50.079170
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.MLPnet       
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-04 19:09:47.969209+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 151, in main
    diffusion = diffusion_config(model)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/config.py", line 65, in __call__
    instance = self._class(*args, **kwargs, **self._dict)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 311, in __init__
    self.text_cond = self.clip_model.encode_text(clip.tokenize('the man is hopping'))
  File "/home/yanyangji/.local/lib/python3.8/site-packages/clip/model.py", line 344, in encode_text
    x = self.token_embedding(text).type(self.dtype)  # [batch_size, n_ctx, d_model]
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/sparse.py", line 160, in forward
    return F.embedding(
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/functional.py", line 2210, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper__index_select)

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-04 11:10:19.866484
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-04 12:21:42.516825
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-04 12:21:42.535661
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.MLPnet       
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-04 20:21:40.534092+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 163, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 369, in forward
    inp = torch.cat([t, cond, x], dim=-1)
TypeError: expected Tensor as element 1 in argument 0, but got dict

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-04 12:22:10.299676
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-04 12:23:16.685875
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-04 12:23:16.704252
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.MLPnet       
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-04 20:23:14.716975+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 163, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 369, in forward
    inp = torch.cat([t, cond, x], dim=-1)
TypeError: expected Tensor as element 1 in argument 0, but got dict

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-04 12:23:44.739316
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-04 12:25:11.807004
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-04 12:25:11.825435
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.MLPnet       
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-04 20:25:09.818156+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 163, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 357, in forward
    print(cond.shape)
AttributeError: 'dict' object has no attribute 'shape'

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-04 12:25:39.618008
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-04 12:26:10.607926
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-04 12:26:10.626880
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.MLPnet       
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-04 20:26:08.610674+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 163, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 359, in forward
    t = self.time_mlp(time)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 359, in forward
    t = self.time_mlp(time)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-04 12:27:09.547425
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-04 12:40:52.717195
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-04 12:40:52.737958
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.MLPnet       
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-04 20:40:50.747110+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 163, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 359, in forward
    t = self.time_mlp(time)
TypeError: expected Tensor as element 1 in argument 0, but got dict

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-04 12:41:34.990636
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-04 12:42:19.172371
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-04 12:42:19.191000
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-04 20:42:17.188688+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
[ utils/training ] Saved model to /home/yanyangji/research/RL/final/decision-diffuser/code/output/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100/checkpoint/state.pt
0:   0.3737 | a0_loss:   1.1599 | t:   4.3949
╒════════════════════╤════════════════════╕
│      a0 loss       │       1.160        │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.374        │
╘════════════════════╧════════════════════╛

1000:   0.0305 | a0_loss:   0.0890 | t:  82.0963
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.089        │
├────────────────────┼────────────────────┤
│       steps        │        1000        │
├────────────────────┼────────────────────┤
│        loss        │       0.031        │
╘════════════════════╧════════════════════╛

2000:   0.0171 | a0_loss:   0.0455 | t:  68.2149
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.045        │
├────────────────────┼────────────────────┤
│       steps        │        2000        │
├────────────────────┼────────────────────┤
│        loss        │       0.017        │
╘════════════════════╧════════════════════╛

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-04 12:46:44.840926
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-04 12:46:44.860080
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.MLPnet       
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-04 20:46:42.817534+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 163, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 371, in forward
    inp = torch.cat([t, cond, x], dim=-1)
TypeError: expected Tensor as element 1 in argument 0, but got dict

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-04 12:47:13.456466
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-04 12:50:27.087308
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-04 12:50:27.106755
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.MLPnet       
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-04 20:50:25.088252+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 163, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 371, in forward
    inp = torch.cat([t, cond, x], dim=-1)
TypeError: expected Tensor as element 1 in argument 0, but got dict

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-04 12:50:55.212991
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-04 13:12:17.414156
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-04 13:12:17.433806
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.MLPnet       
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-04 21:12:15.450241+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 163, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 371, in forward
    inp = torch.cat([t, cond, x], dim=-1)
TypeError: expected Tensor as element 1 in argument 0, but got dict

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-04 13:12:45.221263
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-04 15:42:03.300961
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-04 15:42:03.325874
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-04 23:42:01.222893+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 175, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 117, in train
    loss = loss / self.gradient_accumulate_every
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 117, in train
    loss = loss / self.gradient_accumulate_every
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-04 16:27:04.176975
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 02:02:58.188003
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 02:02:58.209875
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.MLPnet       
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 10:02:56.089335+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 163, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 369, in forward
    inp = torch.cat([t, cond, x], dim=-1)
RuntimeError: Tensors must have same number of dimensions: got 2 and 3

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 02:03:26.077313
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 02:04:18.513355
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 02:04:18.533990
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.MLPnet       
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 10:04:16.464925+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 163, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 369, in forward
    inp = torch.cat([t, cond, x], dim=-1)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 369, in forward
    inp = torch.cat([t, cond, x], dim=-1)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 02:34:09.642839
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 02:35:46.505903
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 02:35:46.525996
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.MLPnet       
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 1                   
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 10:35:44.485364+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 149, in main
    model = model_config()
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/config.py", line 65, in __call__
    instance = self._class(*args, **kwargs, **self._dict)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 347, in __init__
    nn.Linear(1024, self.action_dim),
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 96, in __init__
    self.weight = Parameter(torch.empty((out_features, in_features), **factory_kwargs))
RuntimeError: Trying to create tensor with negative dimension -11: [-11, 1024]

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 02:36:10.001961
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 02:37:18.382826
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 02:37:18.401884
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.MLPnet       
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 1                   
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 10:37:16.350615+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 163, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 369, in forward
    breakpoint()
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 369, in forward
    breakpoint()
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 02:49:11.881462
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 02:49:19.070174
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 02:49:19.089591
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.MLPnet       
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 1                   
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 10:49:17.036955+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 163, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 370, in forward
    out  = self.mlp(inp)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 370, in forward
    out  = self.mlp(inp)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 02:56:44.104722
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 03:00:43.567027
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 03:00:43.586529
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.MLPnet       
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 1                   
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 11:00:41.522523+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 163, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 369, in forward
    inp = torch.cat([t, cond, x], dim=-1)
RuntimeError: Tensors must have same number of dimensions: got 2 and 3

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 03:01:11.435366
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 03:01:40.598108
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 03:01:40.618793
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 11:01:38.536965+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 175, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 117, in train
    loss, infos = self.model.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 117, in train
    loss, infos = self.model.loss(*batch)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 03:04:37.829496
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 03:04:47.966496
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 03:04:47.986528
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 11:04:45.817825+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 03:05:15.061087
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 03:05:15.080740
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 11:05:13.082897+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 175, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 117, in train
    loss = loss / self.gradient_accumulate_every
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 536, in loss
    x_t = x[:, :-1, self.action_dim:]
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 505, in p_losses
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 505, in p_losses
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 03:17:26.735995
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 03:17:34.196466
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 03:17:34.216727
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 11:17:32.129706+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
[ utils/training ] Saved model to /home/yanyangji/research/RL/final/decision-diffuser/code/output/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100/checkpoint/state.pt
0:   0.3738 | a0_loss:   1.1602 | t:   4.2664
╒════════════════════╤════════════════════╕
│      a0 loss       │       1.160        │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.374        │
╘════════════════════╧════════════════════╛

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 03:19:31.154305
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 03:19:31.174563
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.MLPnet       
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 11:19:29.069064+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 149, in main
    model = model_config()
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/config.py", line 65, in __call__
    instance = self._class(*args, **kwargs, **self._dict)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 332, in __init__
    if self.returns_condition:
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 332, in __init__
    if self.returns_condition:
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 03:21:11.024673
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 05:43:30.458735
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 05:43:30.486638
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 13:43:28.247597+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 150, in main
    model = model_config()
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/config.py", line 65, in __call__
    instance = self._class(*args, **kwargs, **self._dict)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 177, in __init__
    ResidualTemporalBlock(dim_in, dim_out, embed_dim=embed_dim, horizon=horizon, kernel_size=kernel_size, mish=mish),
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 95, in __init__
    Rearrange(),
TypeError: __init__() missing 1 required positional argument: 'pattern'

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 05:43:54.599051
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 05:44:16.708897
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 05:44:16.741083
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 13:44:14.525800+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 231, in forward
    x = resnet(x, t)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 109, in forward
    out = self.blocks[0](x) + self.time_mlp(t)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 109, in forward
    out = self.blocks[0](x) + self.time_mlp(t)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 05:45:35.830171
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 05:46:09.379596
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 05:46:09.406552
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 13:46:07.261887+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 232, in forward
    x = resnet(x, t)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 108, in forward
    out = self.blocks[0](x)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/helpers.py", line 68, in forward
    return self.block(x)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 313, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 309, in _conv_forward
    return F.conv1d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [128, 14, 5], expected input[1, 11, 100] to have 14 channels, but got 11 channels instead

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 05:46:38.148591
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 05:47:02.144633
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 05:47:02.171058
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 13:46:59.990784+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 230, in forward
    x = resnet(x, t)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 108, in forward
    out = self.blocks[0](x) + self.time_mlp(t)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/helpers.py", line 68, in forward
    return self.block(x)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 313, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 309, in _conv_forward
    return F.conv1d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [128, 14, 5], expected input[1, 11, 100] to have 14 channels, but got 11 channels instead

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 05:47:32.048452
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 05:48:01.500952
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 05:48:01.527527
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 13:47:59.319341+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 230, in forward
    x = resnet(x, t)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 108, in forward
    out = self.blocks[0](x) + self.time_mlp(t)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/helpers.py", line 68, in forward
    return self.block(x)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 313, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 309, in _conv_forward
    return F.conv1d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [128, 14, 5], expected input[1, 11, 100] to have 14 channels, but got 11 channels instead

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 05:48:30.975244
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 05:52:18.175331
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 05:52:18.200558
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 13:52:16.110995+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 499, in p_losses
    x_noisy = apply_conditioning(x_noisy, cond, 0)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/helpers.py", line 94, in apply_conditioning
    for t, val in conditions.items():
AttributeError: 'Tensor' object has no attribute 'items'

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 05:52:49.043579
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 05:53:09.762679
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 05:53:09.788557
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 13:53:07.632825+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 230, in forward
    x = resnet(x, t)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 108, in forward
    out = self.blocks[0](x) + self.time_mlp(t)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/helpers.py", line 68, in forward
    return self.block(x)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 313, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 309, in _conv_forward
    return F.conv1d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [128, 14, 5], expected input[1, 11, 100] to have 14 channels, but got 11 channels instead

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 05:53:38.462739
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 05:59:51.909163
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 05:59:51.942636
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 13:59:49.663861+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
[ utils/training ] Saved model to /home/yanyangji/research/RL/final/decision-diffuser/code/output/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100/checkpoint/state.pt
0:   0.3737 | a0_loss:   1.1599 | t:   4.6345
╒════════════════════╤════════════════════╕
│      a0 loss       │       1.160        │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.374        │
╘════════════════════╧════════════════════╛

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 06:01:08.249500
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 06:01:08.280273
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 14:01:06.093799+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 225, in forward
    x = resnet(x, t)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 103, in forward
    out = self.blocks[0](x) + self.time_mlp(t)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 103, in forward
    out = self.blocks[0](x) + self.time_mlp(t)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 06:06:05.840394
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 06:50:20.457892
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 06:50:20.479152
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 14:50:18.367265+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 117, in train
    loss, infos = self.model.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 117, in train
    loss, infos = self.model.loss(*batch)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 07:14:54.814375
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 07:15:06.514977
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 07:15:06.536932
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 15:15:04.446711+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 238, in forward
    x = resnet(x, t, c)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 108, in forward
    out = self.blocks[0](x) + self.time_mlp(t) + self.cond_mlp(cond)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x128 and 256x128)

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 07:15:36.530673
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 07:16:51.693896
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 07:16:51.716048
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 15:16:49.655197+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 240, in forward
    x = resnet(x, t, c)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 109, in forward
    c = self.cond_mlp(cond)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x128 and 256x128)

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 07:17:21.677028
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 07:17:54.092393
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 07:17:54.116156
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 15:17:51.943631+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 239, in forward
    x = resnet(x, t, c)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 109, in forward
    c = self.cond_mlp(cond)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x128 and 256x128)

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 07:18:24.362248
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 07:20:36.689823
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 07:20:36.710517
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 15:20:34.641816+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 240, in forward
    x = resnet(x, t, c)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 109, in forward
    c = self.cond_mlp(cond)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x128 and 256x128)

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 07:21:06.621809
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 07:22:12.760728
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 07:22:12.781961
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 15:22:10.711908+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 228, in forward
    if self.returns_condition:
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
TypeError: forward() missing 1 required positional argument: 'cond'

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 07:23:04.108813
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 07:24:05.228004
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 07:24:05.247961
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 15:24:03.123383+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 240, in forward
    x = resnet2(x, t)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 110, in forward
    out = self.blocks[1](out)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 110, in forward
    out = self.blocks[1](out)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 07:33:17.936000
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 07:39:50.712122
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 07:39:50.733600
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 15:39:48.622211+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 239, in forward
    x = resnet(x, t, c)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 110, in forward
    out = self.blocks[1](out)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 110, in forward
    out = self.blocks[1](out)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 07:42:49.584051
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 07:42:57.137333
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 07:42:57.160446
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 15:42:55.057434+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 117, in train
    loss, infos = self.model.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 117, in train
    loss, infos = self.model.loss(*batch)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 07:43:36.505731
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 07:43:44.379110
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 07:43:44.400839
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 15:43:42.277423+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
[ utils/training ] Saved model to /home/yanyangji/research/RL/final/decision-diffuser/code/output/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100/checkpoint/state.pt
0:   0.3713 | a0_loss:   1.1400 | t:   4.7153
╒════════════════════╤════════════════════╕
│      a0 loss       │       1.140        │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.371        │
╘════════════════════╧════════════════════╛

Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 143, in train
    self.inv_render_samples()
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 285, in inv_render_samples
    conditions = apply_dict(
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/arrays.py", line 69, in apply_dict
    for k, v in d.items()
AttributeError: 'Tensor' object has no attribute 'items'

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 07:44:26.973589
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 07:47:07.343940
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 07:47:07.364726
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 15:47:05.250962+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
[ utils/training ] Saved model to /home/yanyangji/research/RL/final/decision-diffuser/code/output/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100/checkpoint/state.pt
0:   0.3713 | a0_loss:   1.1400 | t:   4.6334
╒════════════════════╤════════════════════╕
│      a0 loss       │       1.140        │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.371        │
╘════════════════════╧════════════════════╛

Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 143, in train
    self.inv_render_samples()
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 300, in inv_render_samples
    samples = self.ema_model.conditional_sample(conditions, returns=returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 481, in conditional_sample
    return self.p_sample_loop(shape, cond, returns, *args, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 457, in p_sample_loop
    x = self.p_sample(x, cond, timesteps, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 438, in p_sample
    model_mean, _, model_log_variance = self.p_mean_variance(x=x, cond=cond, t=t, returns=returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 417, in p_mean_variance
    epsilon_cond = self.model(x, cond, t, returns, use_dropout=False)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 234, in forward
    t = torch.cat([t, returns_embed], dim=-1)
RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 11 but got size 2 for tensor number 1 in the list.

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 07:47:49.398132
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 07:49:33.080250
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 07:49:33.101025
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 15:49:30.963150+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
[ utils/training ] Saved model to /home/yanyangji/research/RL/final/decision-diffuser/code/output/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100/checkpoint/state.pt
0:   0.3711 | a0_loss:   1.1393 | t:   4.8772
╒════════════════════╤════════════════════╕
│      a0 loss       │       1.139        │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.371        │
╘════════════════════╧════════════════════╛

Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 143, in train
    self.inv_render_samples()
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 300, in inv_render_samples
    samples = self.ema_model.conditional_sample(conditions, returns=returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 481, in conditional_sample
    return self.p_sample_loop(shape, cond, returns, *args, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 457, in p_sample_loop
    x = self.p_sample(x, cond, timesteps, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 438, in p_sample
    model_mean, _, model_log_variance = self.p_mean_variance(x=x, cond=cond, t=t, returns=returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 417, in p_mean_variance
    epsilon_cond = self.model(x, cond, t, returns, use_dropout=False)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 235, in forward
    t = torch.cat([t, returns_embed], dim=-1)
RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 11 but got size 2 for tensor number 1 in the list.

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 07:50:15.369934
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 07:54:54.579280
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 07:54:54.602856
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 15:54:52.485152+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
[ utils/training ] Saved model to /home/yanyangji/research/RL/final/decision-diffuser/code/output/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100/checkpoint/state.pt
0:   0.3711 | a0_loss:   1.1394 | t:   4.6601
╒════════════════════╤════════════════════╕
│      a0 loss       │       1.139        │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.371        │
╘════════════════════╧════════════════════╛

Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 143, in train
    self.inv_render_samples()
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 300, in inv_render_samples
    samples = self.ema_model.conditional_sample(conditions, returns=returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 481, in conditional_sample
    return self.p_sample_loop(shape, cond, returns, *args, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 457, in p_sample_loop
    x = self.p_sample(x, cond, timesteps, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 438, in p_sample
    model_mean, _, model_log_variance = self.p_mean_variance(x=x, cond=cond, t=t, returns=returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 417, in p_mean_variance
    epsilon_cond = self.model(x, cond, t, returns, use_dropout=False)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 234, in forward
    t = torch.cat([t, returns_embed], dim=-1)
RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 11 but got size 2 for tensor number 1 in the list.

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 07:55:36.507129
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 08:00:40.089482
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 08:00:40.109309
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 16:00:37.997540+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
[ utils/training ] Saved model to /home/yanyangji/research/RL/final/decision-diffuser/code/output/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100/checkpoint/state.pt
0:   0.3711 | a0_loss:   1.1393 | t:   4.6426
╒════════════════════╤════════════════════╕
│      a0 loss       │       1.139        │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.371        │
╘════════════════════╧════════════════════╛

Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 176, in main
    trainer.train(n_train_steps=Config.n_steps_per_epoch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 143, in train
    self.inv_render_samples()
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/training.py", line 300, in inv_render_samples
    samples = self.ema_model.conditional_sample(conditions, returns=returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 481, in conditional_sample
    return self.p_sample_loop(shape, cond, returns, *args, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 457, in p_sample_loop
    x = self.p_sample(x, cond, timesteps, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 438, in p_sample
    model_mean, _, model_log_variance = self.p_mean_variance(x=x, cond=cond, t=t, returns=returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 417, in p_mean_variance
    epsilon_cond = self.model(x, cond, t, returns, use_dropout=False)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 234, in forward
    t = torch.cat([t, returns_embed], dim=-1)
RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 11 but got size 2 for tensor number 1 in the list.

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 08:01:22.317204
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 08:02:31.409129
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 08:02:31.429928
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 16:02:29.317312+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 499, in p_losses
    x_noisy = apply_conditioning(x_noisy, cond, 0)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/helpers.py", line 95, in apply_conditioning
    x[:, t, action_dim:] = val.clone() # batch size, time step, trajectory (all observation)
AttributeError: 'numpy.ndarray' object has no attribute 'clone'

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 08:02:59.909735
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 08:04:10.986289
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 08:04:11.007436
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 16:04:08.870167+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 224, in forward
    c = self.cond_mlp(cond)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
TypeError: linear(): argument 'input' (position 1) must be Tensor, not dict

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 08:04:39.591739
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 08:05:17.596698
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 08:05:17.618368
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 16:05:15.481704+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
[ utils/training ] Saved model to /home/yanyangji/research/RL/final/decision-diffuser/code/output/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100/checkpoint/state.pt
0:   0.3711 | a0_loss:   1.1393 | t:   4.6866
╒════════════════════╤════════════════════╕
│      a0 loss       │       1.139        │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.371        │
╘════════════════════╧════════════════════╛

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 08:15:06.036883
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 08:15:06.059472
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 16:15:03.988364+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 227, in forward
    if self.returns_condition:
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 227, in forward
    if self.returns_condition:
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 08:15:55.990691
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 08:16:02.973193
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 08:16:02.993462
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 16:16:00.894745+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 238, in forward
    if use_dropout:
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 238, in forward
    if use_dropout:
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 08:21:59.685755
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 08:22:53.624243
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 08:22:53.646835
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 16:22:51.537441+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 150, in main
    model = model_config()
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/config.py", line 65, in __call__
    instance = self._class(*args, **kwargs, **self._dict)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 151, in __init__
    if self.returns_condition:
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1265, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'TemporalUnet' object has no attribute 'returns_condition'

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 08:23:17.523763
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 08:24:19.155760
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 08:24:19.176890
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 16:24:17.063490+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 534, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 501, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 250, in forward
    x = resnet(x, t, c)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 108, in forward
    out = self.blocks[0](x) + self.time_mlp(t) + self.cond_mlp(cond)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x256 and 128x128)

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 08:24:49.143089
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 08:25:42.569324
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 08:25:42.594908
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 16:25:40.480127+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
[ utils/training ] Saved model to /home/yanyangji/research/RL/final/decision-diffuser/code/output/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100/checkpoint/state.pt
0:   0.3709 | a0_loss:   1.1378 | t:   4.6570
╒════════════════════╤════════════════════╕
│      a0 loss       │       1.138        │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.371        │
╘════════════════════╧════════════════════╛

1000:   0.0305 | a0_loss:   0.0886 | t:  84.9562
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.089        │
├────────────────────┼────────────────────┤
│       steps        │        1000        │
├────────────────────┼────────────────────┤
│        loss        │       0.030        │
╘════════════════════╧════════════════════╛

2000:   0.0181 | a0_loss:   0.0488 | t:  77.4232
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.049        │
├────────────────────┼────────────────────┤
│       steps        │        2000        │
├────────────────────┼────────────────────┤
│        loss        │       0.018        │
╘════════════════════╧════════════════════╛

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 08:50:11.349031
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 08:50:11.370149
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 16:50:09.259191+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 164, in main
    loss, _ = diffusion.loss(*batch)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 528, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/diffusion.py", line 495, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 252, in forward
    c = self.cond_mlp(self.text_feats.expand(x.size(0), -1))
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 must have the same dtype

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 08:50:40.015078
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 08:51:20.782181
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 08:51:20.803087
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 16:51:18.699407+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Traceback (most recent call last):
  File "/home/yanyangji/anaconda3/envs/decdiff/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py", line 150, in main
    model = model_config()
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/utils/config.py", line 65, in __call__
    instance = self._class(*args, **kwargs, **self._dict)
  File "/home/yanyangji/research/RL/final/decision-diffuser/code/diffuser/models/temporal.py", line 158, in __init__
    clip_model, _ = clip.load("ViT-B/32", device=Config.device).float()
AttributeError: 'tuple' object has no attribute 'float'

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-12-05 08:51:48.829362
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 08:52:19.390690
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 08:52:19.411156
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 16:52:17.273694+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
[ utils/training ] Saved model to /home/yanyangji/research/RL/final/decision-diffuser/code/output/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100/checkpoint/state.pt
0:   0.4051 | a0_loss:   1.2630 | t:   3.7849
╒════════════════════╤════════════════════╕
│      a0 loss       │       1.263        │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.405        │
╘════════════════════╧════════════════════╛

1000:   0.0309 | a0_loss:   0.0895 | t:  90.9076
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.090        │
├────────────────────┼────────────────────┤
│       steps        │        1000        │
├────────────────────┼────────────────────┤
│        loss        │       0.031        │
╘════════════════════╧════════════════════╛

2000:   0.0180 | a0_loss:   0.0484 | t:  74.9469
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.048        │
├────────────────────┼────────────────────┤
│       steps        │        2000        │
├────────────────────┼────────────────────┤
│        loss        │       0.018        │
╘════════════════════╧════════════════════╛

3000:   0.0156 | a0_loss:   0.0405 | t:  75.0833
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.040        │
├────────────────────┼────────────────────┤
│       steps        │        3000        │
├────────────────────┼────────────────────┤
│        loss        │       0.016        │
╘════════════════════╧════════════════════╛

4000:   0.0178 | a0_loss:   0.0518 | t:  75.3749
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.052        │
├────────────────────┼────────────────────┤
│       steps        │        4000        │
├────────────────────┼────────────────────┤
│        loss        │       0.018        │
╘════════════════════╧════════════════════╛

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 10:27:18.754976
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 10:27:18.783920
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 18:27:16.641156+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-12-05 10:30:36.038987
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       │ refs/heads/main     
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/yanyangji/research/RL/final/decision-diffuser/code/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
 returns_condition  │ True                
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
     diffusion      │ models.GaussianInvDynDiffusion
   n_train_steps    │ 1000000.0           
      dataset       │ hopper-medium-expert-v2
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-12-05 10:30:36.069928
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ vll-weiyuan         
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ /home/yanyangji/research/RL/final/decision-diffuser/code/output
      dataset       │ hopper-medium-expert-v2
       model        │ models.TemporalUnet 
     diffusion      │ models.GaussianInvDynDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
      username      │ yanyangji           
      project       │ diffuser            
    script_root     │ /home/yanyangji/research/RL/final/decision-diffuser/code/analysis
    script_path     │ None                
        now         │ 2023-12-05 18:30:33.810879+08:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │ train               
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
[ utils/training ] Saved model to /home/yanyangji/research/RL/final/decision-diffuser/code/output/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100/checkpoint/state.pt
0:   0.4051 | a0_loss:   1.2631 | t:   3.8113
╒════════════════════╤════════════════════╕
│      a0 loss       │       1.263        │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.405        │
╘════════════════════╧════════════════════╛

1000:   0.0308 | a0_loss:   0.0891 | t:  96.2107
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.089        │
├────────────────────┼────────────────────┤
│       steps        │        1000        │
├────────────────────┼────────────────────┤
│        loss        │       0.031        │
╘════════════════════╧════════════════════╛

2000:   0.0178 | a0_loss:   0.0475 | t:  78.6949
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.048        │
├────────────────────┼────────────────────┤
│       steps        │        2000        │
├────────────────────┼────────────────────┤
│        loss        │       0.018        │
╘════════════════════╧════════════════════╛

3000:   0.0157 | a0_loss:   0.0408 | t:  82.1529
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.041        │
├────────────────────┼────────────────────┤
│       steps        │        3000        │
├────────────────────┼────────────────────┤
│        loss        │       0.016        │
╘════════════════════╧════════════════════╛

4000:   0.0177 | a0_loss:   0.0516 | t:  79.5348
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.052        │
├────────────────────┼────────────────────┤
│       steps        │        4000        │
├────────────────────┼────────────────────┤
│        loss        │       0.018        │
╘════════════════════╧════════════════════╛

5000:   0.0238 | a0_loss:   0.0773 | t:  80.1177
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.077        │
├────────────────────┼────────────────────┤
│       steps        │        5000        │
├────────────────────┼────────────────────┤
│        loss        │       0.024        │
╘════════════════════╧════════════════════╛

6000:   0.0184 | a0_loss:   0.0581 | t:  79.9268
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.058        │
├────────────────────┼────────────────────┤
│       steps        │        6000        │
├────────────────────┼────────────────────┤
│        loss        │       0.018        │
╘════════════════════╧════════════════════╛

7000:   0.0195 | a0_loss:   0.0632 | t:  77.3674
╒════════════════════╤════════════════════╕
│      a0 loss       │       0.063        │
├────────────────────┼────────────────────┤
│       steps        │        7000        │
├────────────────────┼────────────────────┤
│        loss        │       0.020        │
╘════════════════════╧════════════════════╛

